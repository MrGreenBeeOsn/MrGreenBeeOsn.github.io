import{r as l,j as e}from"./index-BfZj4ppV.js";const g=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.35-4.35"})]}),A=()=>e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})}),M=()=>e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12 6 12 12 16 14"})]}),B=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),K=()=>{const[i,y]=l.useState(""),[o,m]=l.useState([]),[x,v]=l.useState(!1),[p,d]=l.useState(""),[u,w]=l.useState(new Set),[n,h]=l.useState({}),b="AIzaSyCwBbuwRX7Ufr0l2Ka4cxuTrDuCGSl-Yd8",N=async()=>{if(i.trim()){v(!0),d(""),m([]),h({});try{const s=await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&videoCaption=closedCaption&q="${encodeURIComponent(i)}" english&maxResults=6&key=${b}`);if(!s.ok)throw new Error("API request failed");const t=await s.json();t.items&&t.items.length>0?m(t.items):d("Không tìm thấy video nào. Thử từ khóa khác.")}catch(s){d("Lỗi khi tìm kiếm. Kiểm tra API key hoặc thử lại."),console.error("Search error:",s)}finally{v(!1)}}},S=s=>{s.key==="Enter"&&N()},I=async s=>{w(t=>new Set(t).add(s)),await new Promise(t=>setTimeout(t,2e3));try{const t=Math.floor(Math.random()*5)+2,a=600,j=[],f=new Set,k=[`"...and the word '${i}' means..."`,`"...let's talk about '${i}'..."`,`"...using '${i}' in a sentence..."`,`"...how to pronounce '${i}'..."`,`"...'${i}' is commonly used when..."`,`"...the meaning of '${i}' is..."`,`"...you can say '${i}' like this..."`,`"...here's another example with '${i}'..."`];for(let r=0;r<t;r++){let c;do c=Math.floor(Math.random()*a);while(f.has(c));f.add(c),j.push({time:c,text:k[Math.floor(Math.random()*k.length)]})}j.sort((r,c)=>r.time-c.time),h(r=>({...r,[s]:j}))}catch(t){console.error("Analysis error:",t),h(a=>({...a,[s]:[]}))}finally{w(t=>{const a=new Set(t);return a.delete(s),a})}},$=(s,t)=>{const a=document.getElementById(`yt-${s}`);a&&(a.src=`https://www.youtube.com/embed/${s}?start=${t}&autoplay=1`)},T=s=>{const t=Math.floor(s/60),a=Math.floor(s%60);return`${t}:${a.toString().padStart(2,"0")}`},C=()=>{y(""),m([]),h({}),d("")};return e.jsx("div",{className:"video-search-container",children:e.jsxs("div",{className:"container",children:[e.jsxs("header",{className:"header",children:[e.jsx("h1",{children:"YouTube Word Finder"}),e.jsx("p",{children:"Tìm kiếm và phân tích từ vựng trong video YouTube"})]}),e.jsx("div",{className:"search-section",children:e.jsxs("div",{className:"search-bar",children:[e.jsx("button",{onClick:N,disabled:x||!i.trim(),className:"search-button","aria-label":"Tìm kiếm",children:x?e.jsx("div",{className:"spinner"}):e.jsx(g,{})}),e.jsx("input",{type:"text",value:i,onChange:s=>y(s.target.value),onKeyPress:S,placeholder:"Nhập từ tiếng Anh... (ví dụ: however, although, get along)",className:"search-input"}),i&&e.jsx("button",{onClick:C,className:"clear-button","aria-label":"Xóa",children:e.jsx(A,{})})]})}),p&&e.jsxs("div",{className:"error-message",children:[e.jsx(B,{}),e.jsx("span",{children:p})]}),o.length>0&&e.jsx("div",{className:"results-header",children:e.jsxs("div",{className:"results-info",children:[e.jsxs("span",{className:"search-term",children:["Kết quả cho: ",e.jsxs("strong",{children:['"',i,'"']})]}),e.jsxs("span",{className:"video-count",children:["(",o.length," video)"]})]})}),o.length>0&&e.jsx("div",{className:"video-grid",children:o.map(s=>e.jsxs("div",{className:"video-card",children:[e.jsxs("div",{className:"video-info",children:[e.jsx("h3",{className:"video-title",children:s.snippet.title}),e.jsx("p",{className:"video-channel",children:s.snippet.channelTitle})]}),e.jsx("div",{className:"video-player",children:e.jsx("iframe",{id:`yt-${s.id.videoId}`,src:`https://www.youtube.com/embed/${s.id.videoId}`,title:s.snippet.title,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),e.jsxs("div",{className:"video-actions",children:[e.jsx("button",{onClick:()=>I(s.id.videoId),disabled:u.has(s.id.videoId),className:`analyze-button ${u.has(s.id.videoId)?"loading":""}`,children:u.has(s.id.videoId)?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"small-spinner"}),"Đang phân tích..."]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{}),'Tìm "',i,'" trong video']})}),n[s.id.videoId]&&n[s.id.videoId].length>0&&e.jsxs("div",{className:"timestamps-section",children:[e.jsxs("h4",{className:"timestamps-title",children:[e.jsx(M,{}),"Tìm thấy ",n[s.id.videoId].length," lần xuất hiện:"]}),e.jsx("div",{className:"timestamps-list",children:n[s.id.videoId].map((t,a)=>e.jsxs("button",{onClick:()=>$(s.id.videoId,t.time),className:"timestamp-button",children:[e.jsx("span",{className:"timestamp-time",children:T(t.time)}),e.jsx("span",{className:"timestamp-text",children:t.text})]},a))})]}),n[s.id.videoId]&&n[s.id.videoId].length===0&&e.jsx("div",{className:"no-results",children:"Không tìm thấy từ này trong video"})]})]},s.id.videoId))}),o.length===0&&!x&&!p&&e.jsxs("div",{className:"empty-state",children:[e.jsx(g,{}),e.jsx("p",{className:"empty-title",children:i?`Không tìm thấy video cho "${i}"`:"Bắt đầu tìm kiếm"}),e.jsx("p",{className:"empty-subtitle",children:i?"Thử từ khóa khác":"Nhập từ vựng tiếng Anh để tìm video"})]})]})})};function W(){return e.jsx(e.Fragment,{children:e.jsx("main",{className:"image image3",children:e.jsx("article",{children:e.jsx("div",{className:"table-search",children:e.jsx(K,{})})})})})}export{W as default};

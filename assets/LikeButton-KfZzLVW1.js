import{j as t,r as l}from"./index-DZJz3-6s.js";function j({size:e=14,stroke:r="var(--secondary-color)",fill:i="var(--tertiary-color)",className:s=""}){return t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,fill:i,stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`feather feather-eye ${s}`,viewBox:"0 0 24 24",children:[t.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),t.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function v({postId:e}){const[r,i]=l.useState(0);return l.useEffect(()=>{fetch(`/posts/${e}`).then(o=>o.json()).then(o=>i(o.views||0));const s=`viewed_${e}`,h=localStorage.getItem(s),g=Date.now(),d=1800*1e3;(!h||g-parseInt(h)>d)&&fetch(`/posts/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({views:(r||0)+1})}).then(o=>o.json()).then(o=>{i(o.views),localStorage.setItem(s,g.toString())})},[e]),t.jsxs("div",{children:[r," views"]})}function u({width:e=14,height:r=14,stroke:i="var(--secondary-color)",fill:s="var(--tertiary-color)"}){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 24 24",fill:s,stroke:i,children:t.jsx("path",{d:`M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 \r
               4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 \r
               14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 \r
               6.86-8.55 11.54L12 21.35z`})})}function f({width:e=14,height:r=14,stroke:i="var(--secondary-color)",fill:s="none"}){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 24 24",fill:s,stroke:i,children:t.jsx("path",{d:`M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 \r
               4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 \r
               14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 \r
               6.86-8.55 11.54L12 21.35z`})})}function p({postId:e}){const[r,i]=l.useState(0),[s,h]=l.useState(!1),[g,d]=l.useState(!1),[o,k]=l.useState(!0),x=n=>n===1?`${n} heart`:`${n} hearts`;l.useEffect(()=>{fetch(`http://localhost:3005/posts/${e}`).then(n=>n.json()).then(n=>{i(n.likes||0),k(!1)}).catch(n=>{console.error("Lỗi khi lấy likes:",n);const a=localStorage.getItem(`post-${e}-likes`),c=localStorage.getItem(`post-${e}-isLiked`);a&&i(parseInt(a)),c&&h(JSON.parse(c)),k(!1)})},[e]);const m=()=>{const n=s?r-1:r+1,a=!s;fetch(`http://localhost:3005/posts/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({likes:n})}).then(c=>c.json()).then(c=>{i(c.likes),h(a),d(!0),localStorage.setItem(`post-${e}-isLiked`,JSON.stringify(a)),setTimeout(()=>d(!1),300)}).catch(c=>{console.error("Lỗi khi update likes:",c),i(n),h(a),d(!0),localStorage.setItem(`post-${e}-likes`,n.toString()),localStorage.setItem(`post-${e}-isLiked`,JSON.stringify(a)),setTimeout(()=>d(!1),300)})};return o?t.jsx("div",{className:"like-loading",children:"..."}):t.jsxs("div",{className:"like-container",children:[t.jsxs("button",{className:`like-button ${s?"liked":""} ${g?"animating":""}`,onClick:m,"aria-label":s?"Bỏ thích":"Thích",children:[t.jsx("span",{className:"heart",children:s?t.jsx(u,{}):t.jsx(f,{})}),t.jsx("span",{className:"likes-count",children:x(r)})]}),g&&t.jsx("div",{className:"particles",children:[...Array(6)].map((n,a)=>t.jsx("div",{className:"particle",children:s?t.jsx(u,{}):t.jsx(f,{})},a))})]})}export{j as E,p as L,v as V};

import{j as s,r as l}from"./index-5k7CaOJj.js";function j({size:e=14,stroke:i="var(--secondary-color)",fill:r="var(--tertiary-color)",className:t=""}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,fill:r,stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`feather feather-eye ${t}`,viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function m({postId:e}){const[i,r]=l.useState(0);return l.useEffect(()=>{fetch(`/posts/${e}`).then(o=>o.json()).then(o=>r(o.views||0));const t=`viewed_${e}`,h=localStorage.getItem(t),d=Date.now(),v=1800*1e3;(!h||d-parseInt(h)>v)&&fetch(`/posts/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({views:(i||0)+1})}).then(o=>o.json()).then(o=>{r(o.views),localStorage.setItem(t,d.toString())})},[e]),s.jsxs("div",{children:[i," views"]})}function x({width:e=14,height:i=14,stroke:r="var(--secondary-color)",fill:t="var(--tertiary-color)"}){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:i,viewBox:"0 0 24 24",fill:t,stroke:r,children:s.jsx("path",{d:`M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 \r
               4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 \r
               14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 \r
               6.86-8.55 11.54L12 21.35z`})})}function k({width:e=14,height:i=14,stroke:r="var(--secondary-color)",fill:t="none"}){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:i,viewBox:"0 0 24 24",fill:t,stroke:r,children:s.jsx("path",{d:`M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 \r
               4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 \r
               14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 \r
               6.86-8.55 11.54L12 21.35z`})})}function p({postId:e}){const[i,r]=l.useState(0),[t,h]=l.useState(!1),[d,v]=l.useState(!1),[o,g]=l.useState(!0),w=n=>n===1?`${n} heart`:`${n} hearts`;l.useEffect(()=>{fetch(`http://localhost:3005/posts/${e}`).then(n=>n.json()).then(n=>{r(n.likes||0),g(!1)}).catch(n=>{console.error("Lỗi khi lấy likes:",n);const c=localStorage.getItem(`post-${e}-likes`),a=localStorage.getItem(`post-${e}-isLiked`);c&&r(parseInt(c)),a&&h(JSON.parse(a)),g(!1)})},[e]);const f=()=>{const n=t?i-1:i+1,c=!t;r(n),h(c),v(!0),localStorage.setItem(`post-${e}-likes`,n.toString()),localStorage.setItem(`post-${e}-isLiked`,JSON.stringify(c)),fetch(`http://localhost:3005/posts/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({likes:n})}).then(a=>a.json()).then(a=>{console.log("✅ Đã sync likes với server:",a.likes)}).catch(a=>{console.error("❌ Lỗi sync với server:",a)}),setTimeout(()=>v(!1),300)};return o?s.jsx("div",{className:"like-loading",children:"..."}):s.jsxs("div",{className:"like-container",children:[s.jsxs("button",{className:`like-button ${t?"liked":""} ${d?"animating":""}`,onClick:f,"aria-label":t?"Bỏ thích":"Thích",children:[s.jsx("span",{className:"heart",children:t?s.jsx(x,{}):s.jsx(k,{})}),s.jsx("span",{className:"likes-count",children:w(i)})]}),d&&s.jsx("div",{className:"particles",children:[...Array(6)].map((n,c)=>s.jsx("div",{className:"particle",children:t?s.jsx(x,{}):s.jsx(k,{})},c))})]})}export{j as E,p as L,m as V};

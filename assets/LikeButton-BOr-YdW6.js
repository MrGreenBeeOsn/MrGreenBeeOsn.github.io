import{j as s,r as l}from"./index-6IJUXg8n.js";function x({size:e=14,stroke:i="var(--secondary-color)",fill:r="var(--tertiary-color)",className:o=""}){return s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,fill:r,stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`feather feather-eye ${o}`,viewBox:"0 0 24 24",children:[s.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function j({postId:e}){const[i,r]=l.useState(0);return l.useEffect(()=>{console.log("ðŸŽ¯ ViewCounter mounted for post:",e),fetch(`http://localhost:3005/posts/${e}`).then(t=>{if(console.log("ðŸ“¡ GET Response status:",t.status),!t.ok)throw new Error("GET failed");return t.json()}).then(t=>{console.log("âœ… Nháº­n Ä‘Æ°á»£c views:",t.views),r(t.views||0)}).catch(t=>{console.error("âŒ Lá»—i khi láº¥y views:",t)});const o=`viewed_${e}`,g=localStorage.getItem(o),h=Date.now(),w=1800*1e3;!g||h-parseInt(g)>w?(console.log("ðŸ”„ Äang tÄƒng views..."),fetch(`http://localhost:3005/posts/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({views:i+1})}).then(t=>{if(console.log("ðŸ“¡ PATCH Response status:",t.status),!t.ok)throw new Error("PATCH failed");return t.json()}).then(t=>{console.log("âœ… ÄÃ£ tÄƒng views lÃªn:",t.views),r(t.views),localStorage.setItem(o,h.toString())}).catch(t=>{console.error("âŒ Lá»—i khi tÄƒng views:",t);const v=localStorage.getItem(`post_${e}_views`)||"0",u=parseInt(v)+1;r(u),localStorage.setItem(`post_${e}_views`,u.toString()),localStorage.setItem(o,h.toString())})):console.log("â° ChÆ°a Ä‘á»§ 30 phÃºt Ä‘á»ƒ tÄƒng view")},[e,i]),s.jsxs("div",{className:"view-counter",children:[i," views"]})}function d({width:e=14,height:i=14,stroke:r="var(--secondary-color)",fill:o="var(--tertiary-color)"}){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:i,viewBox:"0 0 24 24",fill:o,stroke:r,children:s.jsx("path",{d:`M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 \r
               4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 \r
               14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 \r
               6.86-8.55 11.54L12 21.35z`})})}function f({width:e=14,height:i=14,stroke:r="var(--secondary-color)",fill:o="none"}){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:i,viewBox:"0 0 24 24",fill:o,stroke:r,children:s.jsx("path",{d:`M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 \r
               4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09C13.09 3.81 \r
               14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 \r
               6.86-8.55 11.54L12 21.35z`})})}function p({postId:e}){const[i,r]=l.useState(0),[o,g]=l.useState(!1),[h,w]=l.useState(!1),[t,v]=l.useState(!0),u=n=>n===1?`${n} heart`:`${n} hearts`;l.useEffect(()=>{fetch(`http://localhost:3005/posts/${e}`).then(n=>n.json()).then(n=>{r(n.likes||0),v(!1)}).catch(n=>{console.error("Lá»—i khi láº¥y likes:",n);const c=localStorage.getItem(`post-${e}-likes`),a=localStorage.getItem(`post-${e}-isLiked`);c&&r(parseInt(c)),a&&g(JSON.parse(a)),v(!1)})},[e]);const k=()=>{const n=o?i-1:i+1,c=!o;r(n),g(c),w(!0),localStorage.setItem(`post-${e}-likes`,n.toString()),localStorage.setItem(`post-${e}-isLiked`,JSON.stringify(c)),fetch(`http://localhost:3005/posts/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({likes:n})}).then(a=>a.json()).then(a=>{console.log("âœ… ÄÃ£ sync likes vá»›i server:",a.likes)}).catch(a=>{console.error("âŒ Lá»—i sync vá»›i server:",a)}),setTimeout(()=>w(!1),300)};return t?s.jsx("div",{className:"like-loading",children:"..."}):s.jsxs("div",{className:"like-container",children:[s.jsxs("button",{className:`like-button ${o?"liked":""} ${h?"animating":""}`,onClick:k,"aria-label":o?"Bá» thÃ­ch":"ThÃ­ch",children:[s.jsx("span",{className:"heart",children:o?s.jsx(d,{}):s.jsx(f,{})}),s.jsx("span",{className:"likes-count",children:u(i)})]}),h&&s.jsx("div",{className:"particles",children:[...Array(6)].map((n,c)=>s.jsx("div",{className:"particle",children:o?s.jsx(d,{}):s.jsx(f,{})},c))})]})}export{x as E,p as L,j as V};

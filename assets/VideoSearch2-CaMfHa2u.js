import{r as o,j as e,N as d}from"./index-g_6zFmLB.js";import{S as $}from"./SearchIcon-xV_dbqq3.js";function M(){const[n,x]=o.useState(!1);return e.jsx("div",{className:"topic-container",children:e.jsxs("div",{className:"flex-topic",children:[e.jsx(d,{to:"/ke-toan",className:`link-rounded ${n?"selected":""}`,style:({isActive:a})=>({background:a?"var(--accent-color-50)":""}),children:e.jsx("mark",{className:"highlight-tertiary-padding-2-4",children:"Kế Toán"})}),e.jsx(d,{to:"/thue",className:`link-rounded ${n?"selected":""}`,style:({isActive:a})=>({background:a?"var(--accent-color-50)":""}),children:e.jsx("mark",{className:"highlight-tertiary-padding-2-4",children:"Thuế"})}),e.jsx(d,{to:"/tai-chinh",className:`link-rounded ${n?"selected":""}`,style:({isActive:a})=>({background:a?"var(--accent-color-50)":""}),children:e.jsx("mark",{className:"highlight-tertiary-padding-2-4",children:"Tài Chính"})}),e.jsx(d,{to:"/luat",className:`link-rounded ${n?"selected":""}`,style:({isActive:a})=>({background:a?"var(--accent-color-50)":""}),children:e.jsx("mark",{className:"highlight-tertiary-padding-2-4",children:"Luật"})}),e.jsx(d,{to:"/doanh-nghiep",className:`link-rounded ${n?"selected":""}`,style:({isActive:a})=>({background:a?"var(--accent-color-50)":""}),children:e.jsx("mark",{className:"highlight-tertiary-padding-2-4",children:"Doanh Nghiệp"})}),e.jsx(d,{to:"/bao-hiem",className:`link-rounded ${n?"selected":""}`,style:({isActive:a})=>({background:a?"var(--accent-color-50)":""}),children:e.jsx("mark",{className:"highlight-tertiary-padding-2-4",children:"Bảo hiểm"})})]})})}const L=()=>e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})}),z=()=>e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12 6 12 12 16 14"})]}),P=()=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),U=()=>{const[n,x]=o.useState(""),[a,u]=o.useState([]),[y,f]=o.useState(!1),[v,p]=o.useState(""),[j,k]=o.useState(new Set),[h,m]=o.useState({}),w="AIzaSyB3fW8kjknyToJTcgTq6xqztA9_c7FNyfU",b=async()=>{if(n.trim()){f(!0),p(""),u([]),m({});try{const s=await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&videoCaption=closedCaption&q="${encodeURIComponent(n)}" english&maxResults=6&key=${w}`);if(!s.ok)throw new Error("API request failed");const t=await s.json();t.items&&t.items.length>0?u(t.items):p("Không tìm thấy video nào. Thử từ khóa khác.")}catch(s){p("Lỗi khi tìm kiếm. Kiểm tra API key hoặc thử lại."),console.error("Search error:",s)}finally{f(!1)}}},I=s=>{s.key==="Enter"&&b()},T=s=>{const t=s.trim().split(":").map(i=>parseInt(i,10));if(t.length===2){const[i,r]=t;if(!isNaN(i)&&!isNaN(r))return i*60+r}else if(t.length===3){const[i,r,c]=t;if(!isNaN(i)&&!isNaN(r)&&!isNaN(c))return i*3600+r*60+c}return null},C=s=>{const t=[],i=s.split(`
`),r=[/^(\d{1,2}:\d{2}(?::\d{2})?)\s*[-–—:]\s*(.+)$/,/^(\d{1,2}:\d{2}(?::\d{2})?)\s+(.+)$/,/^\[(\d{1,2}:\d{2}(?::\d{2})?)\]\s*(.+)$/,/^(\d{1,2}:\d{2}(?::\d{2})?)\s*\|\s*(.+)$/];for(const c of i){const l=c.trim();if(l)for(const K of r){const g=l.match(K);if(g){const F=g[1],N=g[2].trim(),S=T(F);S!==null&&N.length>0&&N.length<200&&t.push({time:S,text:N});break}}}return t.sort((c,l)=>c.time-l.time),t},A=async s=>{k(t=>new Set(t).add(s));try{const t=await fetch(`https://www.googleapis.com/youtube/v3/videos?part=snippet&id=${s}&key=${w}`);if(!t.ok)throw new Error("Failed to fetch video details");const i=await t.json();if(i.items&&i.items.length>0){const r=i.items[0].snippet.description||"",c=C(r);m(l=>({...l,[s]:c}))}else m(r=>({...r,[s]:[]}))}catch(t){console.error("Analysis error:",t),m(i=>({...i,[s]:[]}))}finally{k(t=>{const i=new Set(t);return i.delete(s),i})}},E=(s,t)=>{const i=document.getElementById(`yt-${s}`);i&&(i.src=`https://www.youtube.com/embed/${s}?start=${t}&autoplay=1`)},V=s=>{const t=Math.floor(s/60),i=Math.floor(s%60);return`${t}:${i.toString().padStart(2,"0")}`},B=()=>{x(""),u([]),m({}),p("")};return e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("div",{className:"search-section",children:e.jsxs("div",{className:"search-bar",children:[e.jsx("button",{onClick:b,disabled:y||!n.trim(),className:"search-button","aria-label":"Search",children:y?e.jsx("div",{className:"spinner"}):e.jsx($,{})}),e.jsx("input",{type:"text",value:n,onChange:s=>x(s.target.value),onKeyPress:I,placeholder:"Video Tutorial, Course",className:"search-input"}),n&&e.jsx("button",{onClick:B,className:"clear-button","aria-label":"Xóa",children:e.jsx(L,{})})]})}),e.jsx("header",{children:e.jsx("p",{className:"message-button-below",children:"Find videos and browse the table of contents."})}),v&&e.jsxs("div",{className:"error-message",children:[e.jsx(P,{}),e.jsx("span",{children:v})]}),a.length>0&&e.jsx("div",{className:"results-header",children:e.jsxs("div",{className:"results-info",children:[e.jsxs("span",{className:"search-term",children:["Search results for: ",e.jsxs("strong",{children:['"',n,'"']})]}),e.jsxs("span",{className:"video-count",children:["(",a.length," video)"]})]})}),a.length>0&&e.jsx("div",{className:"video-grid",children:a.map(s=>e.jsxs("div",{className:"video-card",children:[e.jsxs("div",{className:"video-info",children:[e.jsx("h3",{className:"video-title",children:s.snippet.title}),e.jsx("p",{className:"video-channel",children:s.snippet.channelTitle})]}),e.jsx("div",{className:"video-player",children:e.jsx("iframe",{id:`yt-${s.id.videoId}`,src:`https://www.youtube.com/embed/${s.id.videoId}`,title:s.snippet.title,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),e.jsxs("div",{className:"video-actions",children:[e.jsx("button",{onClick:()=>A(s.id.videoId),disabled:j.has(s.id.videoId),className:`analyze-button ${j.has(s.id.videoId)?"loading":""}`,children:j.has(s.id.videoId)?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"small-spinner"}),"Loading table of contents..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{}),"View the table of contents"]})}),h[s.id.videoId]&&h[s.id.videoId].length>0&&e.jsxs("div",{className:"timestamps-section",children:[e.jsxs("h4",{className:"timestamps-title",children:[e.jsx(z,{}),"Table of Contents:"]}),e.jsx("div",{className:"timestamps-list",children:h[s.id.videoId].map((t,i)=>e.jsxs("button",{onClick:()=>E(s.id.videoId,t.time),className:"timestamp-button",children:[e.jsx("span",{className:"timestamp-time",children:V(t.time)}),e.jsx("span",{className:"timestamp-text",children:t.text})]},i))})]}),h[s.id.videoId]&&h[s.id.videoId].length===0&&e.jsx("div",{className:"no-results",children:"This video doesn’t have chapters in its description"})]})]},s.id.videoId))})]})})};export{M as K,U as V};
